document.addEventListener('DOMContentLoaded',()=>{var a=window._APP_DATA,f=document.querySelector('.bi-clock'),g=f?f.nextSibling:null,h=()=>{if(!g)return;if(e<=0){g.nodeValue='00:00';fetch(a.finishUrl,{method:'GET',headers:{'X-CSRF-TOKEN':a.csrfToken}}).then(aA=>{localStorage.clear();clearInterval(i);aA.redirected&&(window.location.href=aA.url)}).catch(aB=>console.error('Logout error:',aB));return}const E=parseInt(~~e/60),_b=e%60;g.nodeValue=`${`${E}`.padStart(2,'0')}:${`${_b}`.padStart(2,'0')}`;e--},i=setInterval(h,1000);let b=localStorage.getItem('quest'+a.currentPage);if(b){var c=document.getElementById(`option_${b}`);c&&(c.checked=!0,c.closest('.form-check').classList.add('selected'))}var d=document.getElementById('finish-btn');d?.addEventListener('click',()=>fetch(a.finishUrl,{method:'GET',headers:{'X-CSRF-TOKEN':a.csrfToken}}).then(A=>{localStorage.clear();clearInterval(i);A.redirected&&(window.location.href=A.url)}).catch(_=>console.error('Logout error:',_)));document.querySelectorAll('input[type="radio"][name="answer"]').forEach(B=>B.addEventListener('change',()=>{for(const C of document.querySelectorAll('.form-check'))C.classList.remove('selected');B.checked&&B.closest('.form-check').classList.add('selected');fetch(a.submitUrl,{method:'POST',headers:{'Content-Type':'application/json','X-CSRF-TOKEN':a.csrfToken},body:JSON.stringify({answer:B.value})}).then(_a=>_a.json()).then(D=>localStorage.setItem('quest'+a.currentPage,D.answered)).catch(_A=>console.error('Gagal menyimpan jawaban:',_A))}));let e=~~parseInt(a.timeLeft);h()});
